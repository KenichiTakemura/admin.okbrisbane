<%= render :partial => 'posts_managements/shared/head' %>
<div class="content">
	<% if !@category %>
	<h2 class="title"><%= t('posts_management_title')%></h2>
	<div class="inner">
		<p>
			<%= t("posts_management_description")%>
		</p>
	</div>
	<% else %>

	<h2 class="title"><%= t("#{@category}")%>&nbsp;<%= t('List') %></h2>
	<div class="inner">
		<% title = t("#{@category}") << t("New") %>
		<%= link_to title, new_post_path(@category, @post.current_page) %>
		<div style="float:right"><%= paginate @post %></div>
		<table class="table">
			<tr>
				<th class="first"><%= t("Id") %></th>
				<th><%= t("hide") %></th>
				<th><%= t("category") %></th>
				<th><%= t("author") %></th>
				<th><%= t("subject") %></th>
				<th><%= t("created_at") %></th>
				<th><%= t("valid_until") %></th>
				<th><%= t("attachment") %></th>
				<th><%= t("viewed") %></th>
				<th><%= t("likes") %></th>
				<th><%= t("dislikes") %></th>
				<th><%= t("rank") %></th>
				<th><%= t("abuse") %></th>
				<th class="last"></th>
			</tr>
			<% if @post.nil? || @post.empty? %>
			<tr><td colspan="14">
			<p>
				<%= t("no_information")%>
			</p>
			</td></tr>
			<% else %>
			<% @post.each do |item| %>
			<tr class="<%= cycle("odd", "even") %>">
				<td><%= item.id %></td>
				<td><%= t("#{item.is_deleted}") %></td>
				<td><%= t("#{item.category}") %></td>
				<td><%= item.posted_by.email %></td>
				<td><%= _truncate(item.subject) %></td>
				<td><%= Common.date_format(item.created_at) %></td>
				<td><%= Common.date_format(item.valid_until) %></td>
				<td>
					<% if !item.attachment.empty? %>
					<ul style="float:left;margin:10px;width:100px;word-wrap: break-word;">
					<% item.attachment.each do |attachment| %>
						<li><%= link_to(attachment.avatar_file_name, attachment.avatar(:original)) %></li>
						<li><%= attachment.avatar_content_type %></li>
						<li><%= attachment.avatar_file_size %> byte</li>
						<% end %>
					</ul>
					<% end %>
					
				</td>
				<td><%= item.views %></td>
				<td><%= item.likes %></td>
				<td><%= item.dislikes %></td>
				<td><%= item.rank %></td>
				<td><%= item.abuse %></td>
				<td><%= link_to t('Show'), show_post_path(@category, item, @post.current_page) %><br/><%= link_to t('Edit'), edit_post_path(@category, item, @post.current_page) %><br/>
					<%= link_to t("#{@category}") << t("Delete"), delete_post_path(@category, item, @post.current_page), method: :delete, data: { confirm: t('confirm_delete') } %></td>
			</tr>
			<% end %>
					<% end %>
		</table>
	</div>
		<% end %>
</div>
